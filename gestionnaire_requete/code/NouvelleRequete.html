<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="font-awesome-4.7.0/css/font-awesome.min.css">
   <link rel="stylesheet" href="Nouvellerequete.css">
    <title>Document</title>
</head>
<body>
    <nav class="navbar"> 
        <div class="logo">
            <img src="S (1).png" alt="logo">
        </div>
        
        <ul>
                <li><a href="Accueil.html">Accueil</a></li>
                <li><a href="requetesEtudiant.html">Mes requetes</a></li>
                <li class="active"><a href="form.html">Nouvelles requetes</a></li>
                <li><a href="Suivie-matiere">Suivie Matiere</a></li>
        </ul>
        
        <div class="user-profile">
           <i class="fa fas fa-bell"></i>
            <img src="businesswoman-executive-professional-success-concept_53876-137644.JPG" alt="profil">
           
        </div>
    </nav>

    
    <!--form-->
    <div class="form-container">
        <h1>Formulaire de requete</h1>
       <form id="newRequestForm">
        <div class="form-group">
            <label>Année academique</label>
            <input type="text" id="année" placeholder="Entrez l'année academique">
        </div>
        <div class="form-group">
            <label>Nom et prenom</label>
            <input type="text" id="name" placeholder="Entrez le nom et le prénom">
        </div>
        <div class="form-group">
            <label >Matricule</label>
            <input type="text" placeholder="Entrez le matricule">
        </div>
        <div class="form-group">
            <label >Département</label>
            <input type="text" id="matricule" placeholder="Entrez le Département">
        </div>
        <div class="form-group">
            <label >Nom Prof</label>
            <input type="text" id="Nomprof" placeholder="Nom prof">
        </div>
        <div class="form-group">
            <label >emailProf</label>
            <input type="email" id="emailProf" placeholder="email@.com">
        </div>
        <div class="form-group">
            <label >Matiere</label>
            <input type="text" placeholder="Entrez la Matiére">
        </div>
        <div class="form-group"></div>
            <label >Cochez le probleme a traiter:</label>
            <div class="checkbox-group">
                <input type="checkbox">Absence de note
                <input type="checkbox">Examen
                <input type="checkbox">CC
                <input type="checkbox">Tpe

            </div> 
        
        <div class="form-group">
            <label >Preciser (Autres) :</label>
            <input type="text" id="precision" placeholder="Expliquez">
        </div>
        <div class="form-group">
            <label >Details du probleme :</label>
            <textarea placeholder="Expliquez le probleme" id="details"></textarea>
        </div>
        <button type="submit" class="submit-btn">Envoyer</button>
    </div>
       </form>
    </div>

    <!--footer-->
    <footer class="footer">
        <div class="pass">
            <div>Rendez-vous sur votre tableau<br>
                de bord etudiant,puis  cliquez sur <br>
                "Soumettre une requete"  Remplissez<br>
               le formulaire et validez</div>
        
                <div>Adresse : ENSPD-Douala, Campus Logbessou<br>
                    Telephone: +237 6 XX XX XX XX <br>
                    Email : contact@polytechnique-douala.com<br>
                </div>
                <div>Site officiel: polytechnique Douala<br>
                    Portail etudiant: Portail etudiant<br>
                    polytechnique Douala
                </div>
                <div >
                   <h2>Reseaux sociaux</h2> <br>
                    Facebook,Twitter,<br>
                    Linkedin,Youtube
                </div>
        </div>
        
    </footer>
    <script>
   document.getElementById('newRequestForm').addEventListener('submit', async function (event) {
    event.preventDefault(); // Empêche le rechargement de la page

    // Récupération des valeurs saisies
    const data = {
        NomEleve: document.getElementById('name').value.trim(),
        Année: document.getElementById('année').value.trim(),
        Matricule: document.getElementById('matricule').value.trim(),
        NomProf: document.getElementById('Nomprof').value.trim(),
        EmailProf: document.getElementById('emailProf').value.trim(),
        Precision: document.getElementById('precision').value.trim(),
        Details: document.getElementById('details').value.trim(),
        Date: new Date().toISOString().split('T')[0] // Ajoute la date courante
    };

    try {
        // Envoie des données à JSON Server
        const response = await fetch('http://localhost:3000/requests', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify(data) // Conversion des données en JSON
        });

        if (response.ok) {
            // Si l'enregistrement réussit :
            alert('Requête soumise avec succès !Votre requête a été enregistrée et sera traitée dans les plus brefs délais.'); // Affiche un message en pop-up

            // Réinitialise le formulaire (vide les champs)
            document.getElementById('newRequestForm').reset();
        } else {
            // Si l'enregistrement échoue :
            alert('Erreur lors de l\'envoi de la requête.');
        }
    } catch (error) {
        console.error('Erreur :', error);
        alert('Une erreur s\'est produite. Vérifiez votre connexion au serveur.');
    }
});


    </script>
</body>
</html>